
        }, () => {
          alert("Permita o acesso à sua localização para usar esta função.");
        });
      } else {
        alert("Seu navegador não suporta geolocalização.");
      }
    }

    function finalizarViagem() {
      const dados = new URLSearchParams();
      dados.append("acao", "finalizar");
      dados.append("id", freteId);

      fetch("https://script.google.com/macros/s/AKfycbwyC2CHl4xjoEMJ12zrM2GSiTN8FEDe_Jl5aglbpZ9x-VcBNNxx-N8zBcfl7iNHJjrbgg/exec", {
        method: "POST",
        body: dados
      })
      .then(res => res.text())
      .then(msg => {
        document.getElementById("status_final").innerText = "✅ Viagem finalizada com sucesso.";
      })
      .catch(() => {
        document.getElementById("status_final").innerText = "❌ Erro ao finalizar a viagem.";
      });
    }
  </script>
</body>
</html>
